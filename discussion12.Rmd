---
title: "Untitled"
author: "Matthew Tillmawitz"
date: "2025-04-23"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars, fig.width = 12,fig.height = 12}
# Load required libraries
library(ggplot2)
library(dplyr)
library(tidyr)
library(patchwork)
library(viridis)  # For colorblind-friendly palettes

# Create the employee productivity dataset
employee_data <- data.frame(
  employee_id = 1:20,
  pre_training = c(65, 70, 55, 68, 77, 62, 55, 80, 78, 69, 60, 67, 71, 55, 73, 64, 68, 75, 66, 70),
  post_training = c(72, 85, 60, 75, 80, 65, 50, 90, 82, 74, 62, 70, 75, 58, 78, 70, 72, 77, 68, 76)
)

# Calculate differences and percentage changes
employee_data <- employee_data %>%
  mutate(
    difference = post_training - pre_training,
    percent_change = (difference / pre_training) * 100
  )

# Calculate summary statistics
avg_pre <- mean(employee_data$pre_training)
avg_post <- mean(employee_data$post_training)
avg_diff <- mean(employee_data$difference)
avg_percent <- mean(employee_data$percent_change)

# Print summary statistics
cat("Average pre-training score:", round(avg_pre, 2), "\n")
cat("Average post-training score:", round(avg_post, 2), "\n")
cat("Average improvement:", round(avg_diff, 2), "points\n")
cat("Average percent change:", round(avg_percent, 2), "%\n")
cat("Number of employees with improved scores:", sum(employee_data$difference > 0), "\n")
cat("Number of employees with decreased scores:", sum(employee_data$difference < 0), "\n")

# Create a long format for some plots
employee_data_long <- employee_data %>%
  pivot_longer(
    cols = c(pre_training, post_training),
    names_to = "training_stage",
    values_to = "productivity"
  )

# Set colorblind-friendly colors
# Using a subset of the Okabe-Ito palette, which is designed for color blindness
pre_color <- "#56B4E9"  # Light blue
post_color <- "#D55E00"  # Vermillion/orange
positive_color <- "#009E73"  # Green
negative_color <- "#CC79A7"  # Pink/purple

# PLOT 1: Scatter plot of pre vs post with reference line
plot1 <- ggplot(employee_data, aes(x = pre_training, y = post_training)) +
  geom_point(size = 3, color = "#0072B2", alpha = 0.7) +  # Dark blue, colorblind-friendly
  geom_text(aes(label = employee_id), vjust = -0.8, size = 3) +
  geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray50") +
  geom_hline(yintercept = avg_post, linetype = "dashed", color = post_color) +
  geom_vline(xintercept = avg_pre, linetype = "dashed", color = pre_color) +
  labs(
    title = "Pre vs Post-Training Productivity",
    subtitle = "Points above the diagonal line show improvement",
    x = "Pre-Training Productivity Score",
    y = "Post-Training Productivity Score"
  ) +
  scale_x_continuous(limits = c(45, 95)) +
  scale_y_continuous(limits = c(45, 95)) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold")
  )

# PLOT 2: Bar chart showing improvement ordered from highest to lowest
plot2 <- employee_data %>%
  arrange(desc(difference)) %>%
  mutate(employee_id = factor(employee_id, levels = employee_id)) %>%
  ggplot(aes(x = employee_id, y = difference, fill = difference > 0)) +
  geom_col() +
  geom_hline(yintercept = 0, linetype = "solid", color = "black") +
  geom_hline(yintercept = avg_diff, linetype = "dashed", color = "black") +
  scale_fill_manual(values = c(negative_color, positive_color), guide = "none") +
  labs(
    title = "Productivity Change After Training",
    subtitle = "Sorted from highest to lowest improvement",
    x = "Employee ID",
    y = "Change in Productivity Score",
    caption = paste("Average improvement:", round(avg_diff, 2), "points")
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

# PLOT 3: Paired bar chart showing pre and post scores for each employee
plot3 <- ggplot(employee_data_long, aes(x = factor(employee_id), y = productivity, fill = training_stage)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.9), width = 0.8) +
  geom_hline(yintercept = avg_pre, linetype = "dashed", color = pre_color) +
  geom_hline(yintercept = avg_post, linetype = "dashed", color = post_color) +
  scale_fill_manual(
    values = c("pre_training" = pre_color, "post_training" = post_color),
    labels = c("Pre-Training", "Post-Training"),
    name = "Training Stage"
  ) +
  labs(
    title = "Pre and Post Training Productivity by Employee",
    x = "Employee ID",
    y = "Productivity Score"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold"),
    legend.position = "top"
  )

# PLOT 4: Density plot of pre and post distributions
plot4 <- ggplot(employee_data_long, aes(x = productivity, fill = training_stage)) +
  geom_density(alpha = 0.6) +
  geom_vline(xintercept = avg_pre, linetype = "dashed", color = pre_color) +
  geom_vline(xintercept = avg_post, linetype = "dashed", color = post_color) +
  scale_fill_manual(
    values = c("pre_training" = pre_color, "post_training" = post_color),
    labels = c("Pre-Training", "Post-Training"),
    name = "Training Stage"
  ) +
  labs(
    title = "Distribution of Productivity Scores",
    x = "Productivity Score",
    y = "Density"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold"),
    legend.position = "top"
  )

# Alternative PLOT 5: Lollipop chart of improvement
plot5 <- employee_data %>%
  mutate(employee_id = reorder(factor(employee_id), difference)) %>%
  ggplot(aes(x = employee_id, y = difference, color = difference > 0)) +
  geom_hline(yintercept = 0, color = "black") +
  geom_segment(aes(xend = employee_id, y = 0, yend = difference), size = 1.2) +
  geom_point(size = 3.5) +
  scale_color_manual(values = c(negative_color, positive_color), guide = "none") +
  coord_flip() +
  labs(
    title = "Productivity Change by Employee",
    subtitle = "Ordered by magnitude of change",
    x = "Employee ID",
    y = "Change in Productivity Score"
  ) +
  geom_hline(yintercept = avg_diff, linetype = "dashed", color = "black") +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold")
  )

# Combine plots using patchwork and save to a file
combined_plots <- (plot1 | plot2) / (plot3 | plot5)
combined_plots <- combined_plots + 
  plot_annotation(
    title = "Employee Productivity: Pre vs Post-Training Analysis",
    subtitle = "95% of employees showed improved productivity after training",
    theme = theme(
      plot.title = element_text(size = 16, face = "bold"),
      plot.subtitle = element_text(size = 12)
    )
  )

# Display the plots in RStudio
combined_plots

# Save the combined plot
# ggsave("productivity_analysis.png", combined_plots, width = 12, height = 10, dpi = 300)
```



```{r cars}
# Load required libraries
library(ggplot2)
library(dplyr)
library(tidyr)
library(patchwork)
library(viridis)  # For colorblind-friendly palettes

# Create the employee productivity dataset
employee_data <- data.frame(
  employee_id = 1:20,
  pre_training = c(65, 70, 55, 68, 77, 62, 55, 80, 78, 69, 60, 67, 71, 55, 73, 64, 68, 75, 66, 70),
  post_training = c(72, 85, 60, 75, 80, 65, 50, 90, 82, 74, 62, 70, 75, 58, 78, 70, 72, 77, 68, 76)
)

# Calculate differences and percentage changes
employee_data <- employee_data %>%
  mutate(
    difference = post_training - pre_training,
    percent_change = (difference / pre_training) * 100
  )

# Calculate summary statistics
avg_pre <- mean(employee_data$pre_training)
avg_post <- mean(employee_data$post_training)
avg_diff <- mean(employee_data$difference)
avg_percent <- mean(employee_data$percent_change)

# Print summary statistics
cat("Average pre-training score:", round(avg_pre, 2), "\n")
cat("Average post-training score:", round(avg_post, 2), "\n")
cat("Average improvement:", round(avg_diff, 2), "points\n")
cat("Average percent change:", round(avg_percent, 2), "%\n")
cat("Number of employees with improved scores:", sum(employee_data$difference > 0), "\n")
cat("Number of employees with decreased scores:", sum(employee_data$difference < 0), "\n")

# Create a long format for some plots
employee_data_long <- employee_data %>%
  pivot_longer(
    cols = c(pre_training, post_training),
    names_to = "training_stage",
    values_to = "productivity"
  )

# Set colorblind-friendly colors
# Using a subset of the Okabe-Ito palette, which is designed for color blindness
pre_color <- "#56B4E9"  # Light blue
post_color <- "#D55E00"  # Vermillion/orange
positive_color <- "#009E73"  # Green
negative_color <- "#CC79A7"  # Pink/purple

# PLOT 2: Bar chart showing improvement ordered from highest to lowest
plot2 <- employee_data %>%
  arrange(desc(difference)) %>%
  mutate(employee_id = factor(employee_id, levels = employee_id)) %>%
  ggplot(aes(x = employee_id, y = difference, fill = difference > 0)) +
  geom_col() +
  geom_hline(yintercept = 0, linetype = "solid", color = "black") +
  geom_hline(yintercept = avg_diff, linetype = "dashed", color = "black") +
  annotate("text", x = 17, y = avg_diff + 0.8, 
         label = paste("Average improvement:", round(avg_diff, 2), "points"),
         size = 3.5, fontface = "bold") +
  scale_fill_manual(values = c(negative_color, positive_color), guide = "none") +
  labs(
    title = "Productivity Change After Training",
    subtitle = "95% of employees showed improved productivity after training",
    x = "Employee",
    y = "Productivity Change"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold"),
    axis.text.x = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

plot2

# Save the combined plot
# ggsave("productivity_analysis.png", combined_plots, width = 12, height = 10, dpi = 300)
```





## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
